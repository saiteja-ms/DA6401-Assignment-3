Starting training run with config: {'language': 'ta', 'embedding_size': 64, 'hidden_size': 128, 'encoder_layers': 1, 'decoder_layers': 1, 'cell_type': 'lstm', 'dropout': 0.2, 'learning_rate': 0.001, 'batch_size': 64, 'n_epochs': 20, 'clip': 1.0, 'teacher_forcing_ratio': 0.5, 'use_attention': True, 'max_seq_len': 50, 'optimizer': 'adam', 'weight_decay': 0.0, 'scheduler': 'none', 'data_dir': '.'}
Looking for training file at: .\ta\lexicons\ta.translit.sampled.train.tsv
Special tokens in vocabulary:
Source vocab keys: ['<PAD>', '<UNK>', '< SOS >', '<EOS>', 'a', 'b', 'c', 'd', 'e', 'f']
Target vocab keys: ['<PAD>', '<UNK>', '< SOS >', '<EOS>', 'ஃ', 'அ', 'ஆ', 'இ', 'ஈ', 'உ']
Successfully loaded Dakshina dataset for ta
Train set: 68218 examples
Dev set: 6827 examples
Test set: 6864 examples
Source vocabulary size: 30
Target vocabulary size: 50
Max sequence length: 50
Using device: cuda
The model has 318,386 trainable parameters
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1066/1066 [04:34<00:00,  3.88it/s]
Evaluating Loss: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:09<00:00, 10.78it/s]
Calculating Accuracy: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:07<00:00, 15.25it/s]
Epoch: 01 | Time: 4m 51s
	Train Loss: 0.4948
	 Val. Loss: 0.4778
	 Val. Accuracy: 0.0001
	 Learning Rate: 0.001000
Saved new best model to best-model-378v4h2y.pt
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1066/1066 [09:37<00:00,  1.85it/s]
Evaluating Loss: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:13<00:00,  8.19it/s]
Calculating Accuracy: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:07<00:00, 14.01it/s]
Epoch: 02 | Time: 9m 58s
	Train Loss: 0.3341
	 Val. Loss: 0.2628
	 Val. Accuracy: 0.1188
	 Learning Rate: 0.001000
Saved new best model to best-model-378v4h2y.pt
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1066/1066 [06:44<00:00,  2.64it/s]
Evaluating Loss: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:13<00:00,  7.95it/s]
Calculating Accuracy: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:07<00:00, 13.44it/s]
Epoch: 03 | Time: 7m 5s
	Train Loss: 0.1500
	 Val. Loss: 0.1491
	 Val. Accuracy: 0.3537
	 Learning Rate: 0.001000
Saved new best model to best-model-378v4h2y.pt
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1066/1066 [06:44<00:00,  2.63it/s]
Evaluating Loss: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:12<00:00,  8.70it/s]
Calculating Accuracy: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:07<00:00, 13.73it/s]
Epoch: 04 | Time: 7m 5s
	Train Loss: 0.1104
	 Val. Loss: 0.1305
	 Val. Accuracy: 0.4451
	 Learning Rate: 0.001000
Saved new best model to best-model-378v4h2y.pt
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1066/1066 [06:22<00:00,  2.79it/s]
Evaluating Loss: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:12<00:00,  8.72it/s]
Calculating Accuracy: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:08<00:00, 12.91it/s]
Epoch: 05 | Time: 6m 43s
	Train Loss: 0.0970
	 Val. Loss: 0.1253
	 Val. Accuracy: 0.4605
	 Learning Rate: 0.001000
Saved new best model to best-model-378v4h2y.pt
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1066/1066 [06:30<00:00,  2.73it/s]
Evaluating Loss: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:12<00:00,  8.82it/s]
Calculating Accuracy: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:07<00:00, 14.14it/s]
Epoch: 06 | Time: 6m 49s
	Train Loss: 0.0879
	 Val. Loss: 0.1196
	 Val. Accuracy: 0.4976
	 Learning Rate: 0.001000
Saved new best model to best-model-378v4h2y.pt
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1066/1066 [06:52<00:00,  2.59it/s]
Evaluating Loss: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:11<00:00,  9.14it/s]
Calculating Accuracy: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:07<00:00, 14.29it/s]
Epoch: 07 | Time: 7m 11s
	Train Loss: 0.0819
	 Val. Loss: 0.1127
	 Val. Accuracy: 0.5286
	 Learning Rate: 0.001000
Saved new best model to best-model-378v4h2y.pt
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1066/1066 [06:30<00:00,  2.73it/s]
Evaluating Loss: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:11<00:00,  9.07it/s]
Calculating Accuracy: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:08<00:00, 13.31it/s]
Epoch: 08 | Time: 6m 50s
	Train Loss: 0.0771
	 Val. Loss: 0.1127
	 Val. Accuracy: 0.5234
	 Learning Rate: 0.001000
Saved new best model to best-model-378v4h2y.pt
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1066/1066 [06:39<00:00,  2.67it/s]
Evaluating Loss: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:11<00:00,  9.53it/s]
Calculating Accuracy: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:07<00:00, 15.00it/s]
Epoch: 09 | Time: 6m 57s
	Train Loss: 0.0737
	 Val. Loss: 0.1103
	 Val. Accuracy: 0.5259
	 Learning Rate: 0.001000
Saved new best model to best-model-378v4h2y.pt
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1066/1066 [07:58<00:00,  2.23it/s]
Evaluating Loss: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:34<00:00,  3.13it/s]
Calculating Accuracy: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:19<00:00,  5.39it/s]
Epoch: 10 | Time: 8m 52s
	Train Loss: 0.0709
	 Val. Loss: 0.1076
	 Val. Accuracy: 0.5433
	 Learning Rate: 0.001000
Saved new best model to best-model-378v4h2y.pt
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1066/1066 [07:59<00:00,  2.22it/s]
Evaluating Loss: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:12<00:00,  8.44it/s]
Calculating Accuracy: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:08<00:00, 13.25it/s]
Epoch: 11 | Time: 8m 20s
	Train Loss: 0.0669
	 Val. Loss: 0.1087
	 Val. Accuracy: 0.5572
	 Learning Rate: 0.001000
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1066/1066 [06:23<00:00,  2.78it/s]
Evaluating Loss: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:12<00:00,  8.84it/s]
Calculating Accuracy: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:07<00:00, 15.06it/s]
Epoch: 12 | Time: 6m 42s
	Train Loss: 0.0644
	 Val. Loss: 0.1074
	 Val. Accuracy: 0.5367
	 Learning Rate: 0.001000
Saved new best model to best-model-378v4h2y.pt
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1066/1066 [05:53<00:00,  3.02it/s]
Evaluating Loss: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:11<00:00,  9.55it/s]
Calculating Accuracy: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:06<00:00, 16.44it/s]
Epoch: 13 | Time: 6m 11s
	Train Loss: 0.0626
	 Val. Loss: 0.1093
	 Val. Accuracy: 0.5458
	 Learning Rate: 0.001000
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1066/1066 [05:51<00:00,  3.04it/s]
Evaluating Loss: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:12<00:00,  8.30it/s]
Calculating Accuracy: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:07<00:00, 15.12it/s]
Epoch: 14 | Time: 6m 11s
	Train Loss: 0.0596
	 Val. Loss: 0.1101
	 Val. Accuracy: 0.5450
	 Learning Rate: 0.001000
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1066/1066 [05:54<00:00,  3.01it/s]
Evaluating Loss: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:10<00:00,  9.76it/s]
Calculating Accuracy: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:06<00:00, 16.87it/s]
Epoch: 15 | Time: 6m 11s
	Train Loss: 0.0575
	 Val. Loss: 0.1069
	 Val. Accuracy: 0.5680
	 Learning Rate: 0.001000
Saved new best model to best-model-378v4h2y.pt
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1066/1066 [05:52<00:00,  3.03it/s]
Evaluating Loss: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:11<00:00,  9.43it/s]
Calculating Accuracy: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:06<00:00, 16.39it/s]
Epoch: 16 | Time: 6m 9s
	Train Loss: 0.0561
	 Val. Loss: 0.1111
	 Val. Accuracy: 0.5629
	 Learning Rate: 0.001000
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1066/1066 [06:14<00:00,  2.85it/s]
Evaluating Loss: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:11<00:00,  9.07it/s]
Calculating Accuracy: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:06<00:00, 16.03it/s]
Epoch: 17 | Time: 6m 32s
	Train Loss: 0.0536
	 Val. Loss: 0.1075
	 Val. Accuracy: 0.5705
	 Learning Rate: 0.001000
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1066/1066 [06:05<00:00,  2.91it/s]
Evaluating Loss: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:11<00:00,  9.18it/s]
Calculating Accuracy: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:07<00:00, 14.70it/s]
Epoch: 18 | Time: 6m 24s
	Train Loss: 0.0524
	 Val. Loss: 0.1129
	 Val. Accuracy: 0.5748
	 Learning Rate: 0.001000
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1066/1066 [06:09<00:00,  2.89it/s]
Evaluating Loss: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:10<00:00, 10.52it/s]
Calculating Accuracy: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:06<00:00, 17.44it/s]
Epoch: 19 | Time: 6m 25s
	Train Loss: 0.0509
	 Val. Loss: 0.1130
	 Val. Accuracy: 0.5732
	 Learning Rate: 0.001000
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1066/1066 [05:25<00:00,  3.28it/s]
Evaluating Loss: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:10<00:00,  9.88it/s]
Calculating Accuracy: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:06<00:00, 16.58it/s]
Epoch: 20 | Time: 5m 42s
	Train Loss: 0.0493
	 Val. Loss: 0.1114
	 Val. Accuracy: 0.5638
	 Learning Rate: 0.001000
Training finished.
Evaluating best model on test set...
C:\Users\DELL\Documents\SEMESTER 8\Deep Learning\Assignment_3\DA6401-Assignment-3\src\training\train.py:308: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_save_path, map_location=device))
Evaluating Loss: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 108/108 [00:11<00:00,  9.21it/s]
Calculating Accuracy: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 108/108 [00:07<00:00, 14.12it/s]
Test Loss: 0.1151 | Test Accuracy: 0.5514
Saved predictions to predictions/attention/predictions-378v4h2y.json
Generating attention visualizations...
Error generating visualizations: cannot import name 'AttentionSeq2Seq' from 'src.models.attention' (C:\Users\DELL\Documents\SEMESTER 8\Deep Learning\Assignment_3\DA6401-Assignment-3\src\models\attention.py)
Traceback (most recent call last):
  File "C:\Users\DELL\Documents\SEMESTER 8\Deep Learning\Assignment_3\DA6401-Assignment-3\src\training\train.py", line 356, in train_model
    from ..visualization.analysis import visualize_attention, visualize_connectivity
  File "C:\Users\DELL\Documents\SEMESTER 8\Deep Learning\Assignment_3\DA6401-Assignment-3\src\visualization\__init__.py", line 1, in <module>
    from .analysis import analyze_errors, compare_models, visualize_attention, visualize_connectivity
  File "C:\Users\DELL\Documents\SEMESTER 8\Deep Learning\Assignment_3\DA6401-Assignment-3\src\visualization\analysis.py", line 10, in <module>
    from src.models.attention import AttentionSeq2Seq
ImportError: cannot import name 'AttentionSeq2Seq' from 'src.models.attention' (C:\Users\DELL\Documents\SEMESTER 8\Deep Learning\Assignment_3\DA6401-Assignment-3\src\models\attention.py)
