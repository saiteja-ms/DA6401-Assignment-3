Starting training run with config: {'language': 'ta', 'embedding_size': 64, 'hidden_size': 128, 'encoder_layers': 1, 'decoder_layers': 1, 'cell_type': 'lstm', 'dropout': 0.2, 'learning_rate': 0.001, 'batch_size': 64, 'n_epochs': 20, 'clip': 1.0, 'teacher_forcing_ratio': 0.5, 'use_attention': False, 'max_seq_len': 50, 'optimizer': 'adam', 'weight_decay': 0.0, 'scheduler': 'none', 'data_dir': '.'}
Looking for training file at: .\ta\lexicons\ta.translit.sampled.train.tsv
Special tokens in vocabulary:
Source vocab keys: ['<PAD>', '<UNK>', '< SOS >', '<EOS>', 'a', 'b', 'c', 'd', 'e', 'f']
Target vocab keys: ['<PAD>', '<UNK>', '< SOS >', '<EOS>', 'ஃ', 'அ', 'ஆ', 'இ', 'ஈ', 'உ']
Successfully loaded Dakshina dataset for ta
Train set: 68218 examples
Dev set: 6827 examples
Test set: 6864 examples
Source vocabulary size: 30
Target vocabulary size: 50
Max sequence length: 50
Using device: cuda
The model has 210,226 trainable parameters
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1066/1066 [06:37<00:00,  2.69it/s]
Evaluating Loss: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:04<00:00, 21.68it/s]
Calculating Accuracy: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:03<00:00, 29.81it/s]
Epoch: 01 | Time: 6m 45s
	Train Loss: 0.5374
	 Val. Loss: 0.5351
	 Val. Accuracy: 0.0000
	 Learning Rate: 0.001000
Saved new best model to best-model-12nh1hau.pt
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1066/1066 [03:08<00:00,  5.64it/s]
Evaluating Loss: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:05<00:00, 19.33it/s]
Calculating Accuracy: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:05<00:00, 18.52it/s]
Epoch: 02 | Time: 3m 20s
	Train Loss: 0.4790
	 Val. Loss: 0.5042
	 Val. Accuracy: 0.0000
	 Learning Rate: 0.001000
Saved new best model to best-model-12nh1hau.pt
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1066/1066 [03:20<00:00,  5.31it/s]
Evaluating Loss: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:05<00:00, 18.97it/s]
Calculating Accuracy: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:06<00:00, 17.25it/s]
Epoch: 03 | Time: 3m 32s
	Train Loss: 0.4439
	 Val. Loss: 0.5128
	 Val. Accuracy: 0.0000
	 Learning Rate: 0.001000
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1066/1066 [03:31<00:00,  5.04it/s]
Evaluating Loss: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:05<00:00, 19.41it/s]
Calculating Accuracy: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:05<00:00, 18.13it/s]
Epoch: 04 | Time: 3m 42s
	Train Loss: 0.4132
	 Val. Loss: 0.4579
	 Val. Accuracy: 0.0004
	 Learning Rate: 0.001000
Saved new best model to best-model-12nh1hau.pt
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1066/1066 [03:21<00:00,  5.28it/s]
Evaluating Loss: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:05<00:00, 19.28it/s]
Calculating Accuracy: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:05<00:00, 18.81it/s]
Epoch: 05 | Time: 3m 33s
	Train Loss: 0.3605
	 Val. Loss: 0.4161
	 Val. Accuracy: 0.0070
	 Learning Rate: 0.001000
Saved new best model to best-model-12nh1hau.pt
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1066/1066 [03:21<00:00,  5.28it/s]
Evaluating Loss: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:05<00:00, 19.87it/s]
Calculating Accuracy: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:05<00:00, 18.74it/s]
Epoch: 06 | Time: 3m 32s
	Train Loss: 0.3137
	 Val. Loss: 0.3685
	 Val. Accuracy: 0.0275
	 Learning Rate: 0.001000
Saved new best model to best-model-12nh1hau.pt
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1066/1066 [03:09<00:00,  5.63it/s]
Evaluating Loss: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:05<00:00, 20.36it/s]
Calculating Accuracy: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:05<00:00, 19.73it/s]
Epoch: 07 | Time: 3m 20s
	Train Loss: 0.2701
	 Val. Loss: 0.3175
	 Val. Accuracy: 0.0634
	 Learning Rate: 0.001000
Saved new best model to best-model-12nh1hau.pt
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1066/1066 [03:16<00:00,  5.42it/s]
Evaluating Loss: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:05<00:00, 19.51it/s]
Calculating Accuracy: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:05<00:00, 18.34it/s]
Epoch: 08 | Time: 3m 27s
	Train Loss: 0.2313
	 Val. Loss: 0.2872
	 Val. Accuracy: 0.1084
	 Learning Rate: 0.001000
Saved new best model to best-model-12nh1hau.pt
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1066/1066 [03:15<00:00,  5.46it/s]
Evaluating Loss: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:05<00:00, 20.04it/s]
Calculating Accuracy: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:05<00:00, 18.59it/s]
Epoch: 09 | Time: 3m 26s
	Train Loss: 0.1959
	 Val. Loss: 0.2528
	 Val. Accuracy: 0.1673
	 Learning Rate: 0.001000
Saved new best model to best-model-12nh1hau.pt
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1066/1066 [03:13<00:00,  5.50it/s]
Evaluating Loss: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:05<00:00, 20.59it/s]
Calculating Accuracy: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:05<00:00, 19.31it/s]
Epoch: 10 | Time: 3m 24s
	Train Loss: 0.1685
	 Val. Loss: 0.2262
	 Val. Accuracy: 0.2354
	 Learning Rate: 0.001000
Saved new best model to best-model-12nh1hau.pt
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1066/1066 [03:40<00:00,  4.84it/s]
Evaluating Loss: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:05<00:00, 19.08it/s]
Calculating Accuracy: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:05<00:00, 18.13it/s]
Epoch: 11 | Time: 3m 51s
	Train Loss: 0.1487
	 Val. Loss: 0.2035
	 Val. Accuracy: 0.2894
	 Learning Rate: 0.001000
Saved new best model to best-model-12nh1hau.pt
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1066/1066 [03:15<00:00,  5.45it/s]
Evaluating Loss: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:05<00:00, 19.88it/s]
Calculating Accuracy: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:05<00:00, 18.29it/s]
Epoch: 12 | Time: 3m 26s
	Train Loss: 0.1341
	 Val. Loss: 0.1942
	 Val. Accuracy: 0.3105
	 Learning Rate: 0.001000
Saved new best model to best-model-12nh1hau.pt
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1066/1066 [03:16<00:00,  5.42it/s]
Evaluating Loss: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:05<00:00, 19.22it/s]
Calculating Accuracy: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:05<00:00, 18.06it/s]
Epoch: 13 | Time: 3m 28s
	Train Loss: 0.1231
	 Val. Loss: 0.1806
	 Val. Accuracy: 0.3514
	 Learning Rate: 0.001000
Saved new best model to best-model-12nh1hau.pt
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1066/1066 [03:22<00:00,  5.26it/s]
Evaluating Loss: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:05<00:00, 17.93it/s]
Calculating Accuracy: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:05<00:00, 18.35it/s]
Epoch: 14 | Time: 3m 34s
	Train Loss: 0.1156
	 Val. Loss: 0.1772
	 Val. Accuracy: 0.3555
	 Learning Rate: 0.001000
Saved new best model to best-model-12nh1hau.pt
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1066/1066 [03:18<00:00,  5.36it/s]
Evaluating Loss: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:05<00:00, 19.79it/s]
Calculating Accuracy: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:05<00:00, 18.56it/s]
Epoch: 15 | Time: 3m 30s
	Train Loss: 0.1077
	 Val. Loss: 0.1791
	 Val. Accuracy: 0.3612
	 Learning Rate: 0.001000
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1066/1066 [03:07<00:00,  5.68it/s]
Evaluating Loss: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:05<00:00, 18.17it/s]
Calculating Accuracy: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:05<00:00, 18.11it/s]
Epoch: 16 | Time: 3m 19s
	Train Loss: 0.1027
	 Val. Loss: 0.1704
	 Val. Accuracy: 0.3890
	 Learning Rate: 0.001000
Saved new best model to best-model-12nh1hau.pt
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1066/1066 [03:46<00:00,  4.71it/s]
Evaluating Loss: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:16<00:00,  6.46it/s]
Calculating Accuracy: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:14<00:00,  7.59it/s]
Epoch: 17 | Time: 4m 17s
	Train Loss: 0.0979
	 Val. Loss: 0.1683
	 Val. Accuracy: 0.3940
	 Learning Rate: 0.001000
Saved new best model to best-model-12nh1hau.pt
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1066/1066 [06:10<00:00,  2.87it/s]
Evaluating Loss: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:05<00:00, 19.42it/s]
Calculating Accuracy: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:06<00:00, 17.30it/s]
Epoch: 18 | Time: 6m 22s
	Train Loss: 0.0934
	 Val. Loss: 0.1674
	 Val. Accuracy: 0.4100
	 Learning Rate: 0.001000
Saved new best model to best-model-12nh1hau.pt
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1066/1066 [03:24<00:00,  5.21it/s]
Evaluating Loss: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:06<00:00, 17.69it/s]
Calculating Accuracy: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:06<00:00, 17.14it/s]
Epoch: 19 | Time: 3m 37s
	Train Loss: 0.0892
	 Val. Loss: 0.1651
	 Val. Accuracy: 0.4145
	 Learning Rate: 0.001000
Saved new best model to best-model-12nh1hau.pt
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1066/1066 [03:27<00:00,  5.13it/s]
Evaluating Loss: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:06<00:00, 17.62it/s]
Calculating Accuracy: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:06<00:00, 17.16it/s]
Epoch: 20 | Time: 3m 39s
	Train Loss: 0.0864
	 Val. Loss: 0.1620
	 Val. Accuracy: 0.4195
	 Learning Rate: 0.001000
Saved new best model to best-model-12nh1hau.pt
Training finished.
Evaluating best model on test set...
C:\Users\DELL\Documents\SEMESTER 8\Deep Learning\Assignment_3\DA6401-Assignment-3\src\training\train.py:308: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_save_path, map_location=device))
Evaluating Loss: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 108/108 [00:06<00:00, 17.44it/s]
Calculating Accuracy: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 108/108 [00:06<00:00, 17.32it/s]
Test Loss: 0.1697 | Test Accuracy: 0.4036
Saved predictions to predictions/vanilla/predictions-12nh1hau.json
