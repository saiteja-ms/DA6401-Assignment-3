Starting training run with config: {'batch_size': 128, 'cell_type': 'gru', 'clip': 1, 'data_dir': '.', 'dropout': 0, 'embedding_size': 128, 'hidden_size': 64, 'language': 'ta', 'learning_rate': 0.007985198325782037, 'max_seq_len': 50, 'momentum': 0.9, 'n_epochs': 20, 'num_layers': 3, 'optimizer': 'adam', 'rmsprop_alpha': 0.99, 'scheduler': 'plateau', 'scheduler_factor': 0.5, 'scheduler_patience': 5, 'scheduler_t_max': 20, 'teacher_forcing_ratio': 0.7, 'use_attention': False, 'weight_decay': 0}
Looking for training file at: .\ta\lexicons\ta.translit.sampled.train.tsv
Special tokens in vocabulary:
Source vocab keys: ['<PAD>', '<UNK>', '< SOS >', '<EOS>', 'a', 'b', 'c', 'd', 'e', 'f']
Target vocab keys: ['<PAD>', '<UNK>', '< SOS >', '<EOS>', 'ஃ', 'அ', 'ஆ', 'இ', 'ஈ', 'உ']
Successfully loaded Dakshina dataset for ta
Train set: 68218 examples
Dev set: 6827 examples
Test set: 6864 examples
Source vocabulary size: 30
Target vocabulary size: 50
Max sequence length: 50
Using device: cuda
The model has 187,826 trainable parameters
C:\Users\DELL\anaconda3\envs\Transliteration\lib\site-packages\torch\optim\lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
Training: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 533/533 [05:02<00:00,  1.76it/s]
Evaluating Loss: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 54/54 [00:03<00:00, 17.18it/s]
Calculating Accuracy: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 54/54 [00:04<00:00, 13.02it/s]
Epoch: 01 | Time: 5m 9s
	Train Loss: 0.5376
	 Val. Loss: 0.4644
	 Val. Accuracy: 0.0000
	 Learning Rate: 0.007985
Saved new best model to best-model-3qne9n5b.pt
Training: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 533/533 [02:27<00:00,  3.61it/s]
Evaluating Loss: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 54/54 [00:03<00:00, 16.32it/s]
Calculating Accuracy: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 54/54 [00:04<00:00, 12.51it/s]
Epoch: 02 | Time: 2m 35s
	Train Loss: 0.4523
	 Val. Loss: 0.4382
	 Val. Accuracy: 0.0003
	 Learning Rate: 0.007985
Saved new best model to best-model-3qne9n5b.pt
Training: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 533/533 [02:29<00:00,  3.56it/s]
Evaluating Loss: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 54/54 [00:03<00:00, 14.45it/s]
Calculating Accuracy: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 54/54 [00:05<00:00, 10.03it/s]
Epoch: 03 | Time: 2m 38s
	Train Loss: 0.3795
	 Val. Loss: 0.4105
	 Val. Accuracy: 0.0053
	 Learning Rate: 0.007985
Saved new best model to best-model-3qne9n5b.pt
Training: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 533/533 [02:46<00:00,  3.20it/s]
Evaluating Loss: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 54/54 [00:03<00:00, 14.22it/s]
Calculating Accuracy: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 54/54 [00:05<00:00,  9.77it/s]
Epoch: 04 | Time: 2m 55s
	Train Loss: 0.3412
	 Val. Loss: 0.3840
	 Val. Accuracy: 0.0125
	 Learning Rate: 0.007985
Saved new best model to best-model-3qne9n5b.pt
Training: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 533/533 [02:41<00:00,  3.30it/s]
Evaluating Loss: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 54/54 [00:03<00:00, 14.40it/s]
Calculating Accuracy: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 54/54 [00:05<00:00, 10.29it/s]
Epoch: 05 | Time: 2m 50s
	Train Loss: 0.3136
	 Val. Loss: 0.3724
	 Val. Accuracy: 0.0167
	 Learning Rate: 0.007985
Saved new best model to best-model-3qne9n5b.pt
Training: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 533/533 [02:34<00:00,  3.46it/s]
Evaluating Loss: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 54/54 [00:03<00:00, 14.10it/s]
Calculating Accuracy: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 54/54 [00:05<00:00, 10.44it/s]
Epoch: 06 | Time: 2m 43s
	Train Loss: 0.2947
	 Val. Loss: 0.3605
	 Val. Accuracy: 0.0302
	 Learning Rate: 0.007985
Saved new best model to best-model-3qne9n5b.pt
Training: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 533/533 [02:36<00:00,  3.41it/s]
Evaluating Loss: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 54/54 [00:03<00:00, 14.17it/s]
Calculating Accuracy: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 54/54 [00:05<00:00, 10.68it/s]
Epoch: 07 | Time: 2m 45s
	Train Loss: 0.2789
	 Val. Loss: 0.3625
	 Val. Accuracy: 0.0371
	 Learning Rate: 0.007985
Training: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 533/533 [02:30<00:00,  3.54it/s]
Evaluating Loss: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 54/54 [00:03<00:00, 15.56it/s]
Calculating Accuracy: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 54/54 [00:04<00:00, 10.89it/s]
Epoch: 08 | Time: 2m 38s
	Train Loss: 0.2659
	 Val. Loss: 0.3529
	 Val. Accuracy: 0.0425
	 Learning Rate: 0.007985
Saved new best model to best-model-3qne9n5b.pt
Training: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 533/533 [02:26<00:00,  3.63it/s]
Evaluating Loss: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 54/54 [00:03<00:00, 15.14it/s]
Calculating Accuracy: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 54/54 [00:05<00:00, 10.62it/s]
Epoch: 09 | Time: 2m 35s
	Train Loss: 0.2550
	 Val. Loss: 0.3433
	 Val. Accuracy: 0.0517
	 Learning Rate: 0.007985
Saved new best model to best-model-3qne9n5b.pt
Training: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 533/533 [02:32<00:00,  3.50it/s]
Evaluating Loss: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 54/54 [00:03<00:00, 15.38it/s]
Calculating Accuracy: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 54/54 [00:04<00:00, 11.24it/s]
Epoch: 10 | Time: 2m 40s
	Train Loss: 0.2449
	 Val. Loss: 0.3425
	 Val. Accuracy: 0.0719
	 Learning Rate: 0.007985
Saved new best model to best-model-3qne9n5b.pt
Training: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 533/533 [02:32<00:00,  3.50it/s]
Evaluating Loss: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 54/54 [00:03<00:00, 14.98it/s]
Calculating Accuracy: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 54/54 [00:04<00:00, 10.90it/s]
Epoch: 11 | Time: 2m 40s
	Train Loss: 0.2351
	 Val. Loss: 0.3447
	 Val. Accuracy: 0.0694
	 Learning Rate: 0.007985
Training: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 533/533 [02:32<00:00,  3.50it/s]
Evaluating Loss: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 54/54 [00:03<00:00, 14.32it/s]
Calculating Accuracy: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 54/54 [00:05<00:00,  9.96it/s]
Epoch: 12 | Time: 2m 41s
	Train Loss: 0.2285
	 Val. Loss: 0.3434
	 Val. Accuracy: 0.0754
	 Learning Rate: 0.007985
Training: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 533/533 [02:26<00:00,  3.63it/s]
Evaluating Loss: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 54/54 [00:03<00:00, 15.27it/s]
Calculating Accuracy: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 54/54 [00:05<00:00, 10.63it/s]
Epoch: 13 | Time: 2m 35s
	Train Loss: 0.2195
	 Val. Loss: 0.3318
	 Val. Accuracy: 0.0921
	 Learning Rate: 0.007985
Saved new best model to best-model-3qne9n5b.pt
Training: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 533/533 [02:55<00:00,  3.03it/s]
Evaluating Loss: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 54/54 [00:03<00:00, 13.64it/s]
Calculating Accuracy: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 54/54 [00:05<00:00, 10.36it/s]
Epoch: 14 | Time: 3m 4s
	Train Loss: 0.2149
	 Val. Loss: 0.3209
	 Val. Accuracy: 0.1110
	 Learning Rate: 0.007985
Saved new best model to best-model-3qne9n5b.pt
Training: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 533/533 [02:30<00:00,  3.55it/s]
Evaluating Loss: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 54/54 [00:03<00:00, 15.27it/s]
Calculating Accuracy: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 54/54 [00:05<00:00, 10.67it/s]
Epoch: 15 | Time: 2m 38s
	Train Loss: 0.2066
	 Val. Loss: 0.3358
	 Val. Accuracy: 0.0945
	 Learning Rate: 0.007985
Training: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 533/533 [02:34<00:00,  3.45it/s]
Evaluating Loss: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 54/54 [00:03<00:00, 14.61it/s]
Calculating Accuracy: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 54/54 [00:05<00:00, 10.80it/s]
Epoch: 16 | Time: 2m 43s
	Train Loss: 0.2024
	 Val. Loss: 0.3196
	 Val. Accuracy: 0.1255
	 Learning Rate: 0.007985
Saved new best model to best-model-3qne9n5b.pt
Training: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 533/533 [02:34<00:00,  3.45it/s]
Evaluating Loss: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 54/54 [00:04<00:00, 13.48it/s]
Calculating Accuracy: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 54/54 [00:05<00:00, 10.57it/s]
Epoch: 17 | Time: 2m 43s
	Train Loss: 0.1969
	 Val. Loss: 0.3252
	 Val. Accuracy: 0.1292
	 Learning Rate: 0.007985
Training: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 533/533 [02:44<00:00,  3.23it/s]
Evaluating Loss: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 54/54 [00:03<00:00, 14.12it/s]
Calculating Accuracy: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 54/54 [00:05<00:00, 10.58it/s]
Epoch: 18 | Time: 2m 53s
	Train Loss: 0.1943
	 Val. Loss: 0.3095
	 Val. Accuracy: 0.1368
	 Learning Rate: 0.007985
Saved new best model to best-model-3qne9n5b.pt
Training: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 533/533 [02:35<00:00,  3.42it/s]
Evaluating Loss: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 54/54 [00:03<00:00, 15.26it/s]
Calculating Accuracy: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 54/54 [00:04<00:00, 10.99it/s]
Epoch: 19 | Time: 2m 44s
	Train Loss: 0.1886
	 Val. Loss: 0.3210
	 Val. Accuracy: 0.1312
	 Learning Rate: 0.007985
Training: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 533/533 [02:25<00:00,  3.67it/s]
Evaluating Loss: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 54/54 [00:03<00:00, 15.42it/s]
Calculating Accuracy: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 54/54 [00:04<00:00, 10.99it/s]
Epoch: 20 | Time: 2m 33s
	Train Loss: 0.1865
	 Val. Loss: 0.3077
	 Val. Accuracy: 0.1438
	 Learning Rate: 0.007985
Saved new best model to best-model-3qne9n5b.pt
Training finished.
Evaluating best model on test set...
C:\Users\DELL\Documents\SEMESTER 8\Deep Learning\Assignment_3\DA6401-Assignment-3\src\training\train.py:308: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_save_path, map_location=device))
Evaluating Loss: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 54/54 [00:03<00:00, 15.55it/s]
Calculating Accuracy: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 54/54 [00:04<00:00, 11.27it/s]
Test Loss: 0.3233 | Test Accuracy: 0.1288
Saved predictions to predictions/vanilla/predictions-3qne9n5b.json
