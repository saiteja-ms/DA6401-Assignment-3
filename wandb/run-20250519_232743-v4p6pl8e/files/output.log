Starting training run with config: {'language': 'ta', 'embedding_size': 64, 'hidden_size': 128, 'encoder_layers': 1, 'decoder_layers': 1, 'cell_type': 'lstm', 'dropout': 0.2, 'learning_rate': 0.001, 'batch_size': 64, 'n_epochs': 20, 'clip': 1.0, 'teacher_forcing_ratio': 0.5, 'use_attention': False, 'data_dir': '.', 'max_seq_len': 50}
Attempting to load data from: .\ta\lexicons\ta.translit.sampled.train.tsv
Source vocabulary size: 30
Target vocabulary size: 50
Sample Source Vocab: [('<PAD>', 0), ('<UNK>', 1), ('<SOS>', 2), ('<EOS>', 3), ('a', 4), ('b', 5), ('c', 6), ('d', 7), ('e', 8), ('f', 9)]
Sample Target Vocab: [('<PAD>', 0), ('<UNK>', 1), ('<SOS>', 2), ('<EOS>', 3), ('ஃ', 4), ('அ', 5), ('ஆ', 6), ('இ', 7), ('ஈ', 8), ('உ', 9)]
Successfully loaded Dakshina dataset for ta
Train set: 68218 examples
Dev set: 6827 examples
Test set: 6864 examples
Max sequence length: 50
Using device: cuda
The model has 210,226 trainable parameters
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1066/1066 [01:59<00:00,  8.95it/s]
Evaluating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:03<00:00, 33.23it/s]
Calculating Accuracy: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:01<00:00, 56.44it/s]
Epoch: 01 | Time: 2m 4s
	Train Loss: 2.8152
	 Val. Loss: 2.9916
	 Val. Accuracy: 0.0000
Saved new best model to best-model-v4p6pl8e.pt
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1066/1066 [02:01<00:00,  8.78it/s]
Evaluating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:03<00:00, 31.42it/s]
Calculating Accuracy: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:02<00:00, 44.86it/s]
Epoch: 02 | Time: 2m 7s
	Train Loss: 2.5495
	 Val. Loss: 2.7694
	 Val. Accuracy: 0.0001
Saved new best model to best-model-v4p6pl8e.pt
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1066/1066 [01:53<00:00,  9.40it/s]
Evaluating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:03<00:00, 30.89it/s]
Calculating Accuracy: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:03<00:00, 31.17it/s]
Epoch: 03 | Time: 2m 0s
	Train Loss: 2.2233
	 Val. Loss: 2.5196
	 Val. Accuracy: 0.0018
Saved new best model to best-model-v4p6pl8e.pt
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1066/1066 [02:00<00:00,  8.87it/s]
Evaluating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:03<00:00, 32.32it/s]
Calculating Accuracy: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:03<00:00, 34.98it/s]
Epoch: 04 | Time: 2m 6s
	Train Loss: 1.9614
	 Val. Loss: 2.3354
	 Val. Accuracy: 0.0037
Saved new best model to best-model-v4p6pl8e.pt
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1066/1066 [02:27<00:00,  7.22it/s]
Evaluating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:04<00:00, 22.98it/s]
Calculating Accuracy: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:04<00:00, 22.51it/s]
Epoch: 05 | Time: 2m 36s
	Train Loss: 1.7582
	 Val. Loss: 2.1473
	 Val. Accuracy: 0.0293
Saved new best model to best-model-v4p6pl8e.pt
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1066/1066 [02:54<00:00,  6.13it/s]
Evaluating: 100%|█████████████| 107/107 [00:04<00:00, 22.06it/s]
Calculating Accuracy: 100%|███| 107/107 [00:04<00:00, 21.58it/s]
Epoch: 06 | Time: 3m 3s
	Train Loss: 1.5335
	 Val. Loss: 1.9647
	 Val. Accuracy: 0.0686
Saved new best model to best-model-v4p6pl8e.pt
Training: 100%|█████████████| 1066/1066 [03:00<00:00,  5.91it/s]
Evaluating: 100%|████████████████████████████████████| 107/107 [00:04<00:00, 22.48it/s]
Calculating Accuracy: 100%|██████████████████████████| 107/107 [00:04<00:00, 22.14it/s]
Epoch: 07 | Time: 3m 9s
	Train Loss: 1.3591
	 Val. Loss: 1.7849
	 Val. Accuracy: 0.1252
Saved new best model to best-model-v4p6pl8e.pt
Training: 100%|████████████████████████████████████| 1066/1066 [02:53<00:00,  6.14it/s]
Evaluating: 100%|████████████████████████████████████| 107/107 [00:04<00:00, 23.21it/s]
Calculating Accuracy: 100%|██████████████████████████| 107/107 [00:04<00:00, 22.50it/s]
Epoch: 08 | Time: 3m 2s
	Train Loss: 1.2211
	 Val. Loss: 1.6625
	 Val. Accuracy: 0.1730
Saved new best model to best-model-v4p6pl8e.pt
Training: 100%|████████████████████████████████████| 1066/1066 [02:49<00:00,  6.29it/s]
Evaluating: 100%|████████████████████████████████████| 107/107 [00:04<00:00, 22.97it/s]
Calculating Accuracy: 100%|██████████████████████████| 107/107 [00:04<00:00, 22.50it/s]
Epoch: 09 | Time: 2m 58s
	Train Loss: 1.1251
	 Val. Loss: 1.6038
	 Val. Accuracy: 0.2103
Saved new best model to best-model-v4p6pl8e.pt
Training: 100%|████████████████████████████████████| 1066/1066 [02:46<00:00,  6.40it/s]
Evaluating: 100%|████████████████████████████████████| 107/107 [00:04<00:00, 23.04it/s]
Calculating Accuracy: 100%|██████████████████████████| 107/107 [00:04<00:00, 22.72it/s]
Epoch: 10 | Time: 2m 56s
	Train Loss: 1.0547
	 Val. Loss: 1.5571
	 Val. Accuracy: 0.2345
Saved new best model to best-model-v4p6pl8e.pt
Training: 100%|████████████████████████████████████| 1066/1066 [02:50<00:00,  6.26it/s]
Evaluating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:04<00:00, 24.32it/s]
Calculating Accuracy: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:04<00:00, 23.68it/s]
Epoch: 11 | Time: 2m 59s
	Train Loss: 0.9966
	 Val. Loss: 1.4966
	 Val. Accuracy: 0.2727
Saved new best model to best-model-v4p6pl8e.pt
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1066/1066 [02:51<00:00,  6.22it/s]
Evaluating: 100%|████████████████████████████████████| 107/107 [00:04<00:00, 23.01it/s]
Calculating Accuracy: 100%|██████████████████████████| 107/107 [00:04<00:00, 23.25it/s]
Epoch: 12 | Time: 3m 0s
	Train Loss: 0.9543
	 Val. Loss: 1.4477
	 Val. Accuracy: 0.2965
Saved new best model to best-model-v4p6pl8e.pt
Training: 100%|████████████████████████████████████| 1066/1066 [02:46<00:00,  6.39it/s]
Evaluating: 100%|████████████████████████████████████| 107/107 [00:04<00:00, 24.47it/s]
Calculating Accuracy: 100%|██████████████████████████| 107/107 [00:04<00:00, 23.97it/s]
Epoch: 13 | Time: 2m 55s
	Train Loss: 0.9146
	 Val. Loss: 1.4501
	 Val. Accuracy: 0.3092
Training: 100%|████████████████████████████████████| 1066/1066 [02:48<00:00,  6.34it/s]
Evaluating: 100%|████████████████████████████████████| 107/107 [00:04<00:00, 22.83it/s]
Calculating Accuracy: 100%|██████████████████████████| 107/107 [00:04<00:00, 23.02it/s]
Epoch: 14 | Time: 2m 57s
	Train Loss: 0.8872
	 Val. Loss: 1.3967
	 Val. Accuracy: 0.3357
Saved new best model to best-model-v4p6pl8e.pt
Training: 100%|████████████████████████████████████| 1066/1066 [02:48<00:00,  6.32it/s]
Evaluating: 100%|████████████████████████████████████| 107/107 [00:04<00:00, 22.90it/s]
Calculating Accuracy: 100%|██████████████████████████| 107/107 [00:04<00:00, 21.88it/s]
Epoch: 15 | Time: 2m 58s
	Train Loss: 0.8575
	 Val. Loss: 1.4124
	 Val. Accuracy: 0.3438
Training: 100%|████████████████████████████████████| 1066/1066 [02:57<00:00,  6.00it/s]
Evaluating: 100%|████████████████████████████████████| 107/107 [00:04<00:00, 22.86it/s]
Calculating Accuracy: 100%|██████████████████████████| 107/107 [00:04<00:00, 21.97it/s]
Epoch: 16 | Time: 3m 7s
	Train Loss: 0.8361
	 Val. Loss: 1.3801
	 Val. Accuracy: 0.3533
Saved new best model to best-model-v4p6pl8e.pt
Training: 100%|████████████████████████████████████| 1066/1066 [02:52<00:00,  6.19it/s]
Evaluating: 100%|████████████████████████████████████| 107/107 [00:04<00:00, 22.25it/s]
Calculating Accuracy: 100%|██████████████████████████| 107/107 [00:04<00:00, 23.10it/s]
Epoch: 17 | Time: 3m 1s
	Train Loss: 0.8091
	 Val. Loss: 1.3416
	 Val. Accuracy: 0.3694
Saved new best model to best-model-v4p6pl8e.pt
Training: 100%|████████████████████████████████████| 1066/1066 [02:55<00:00,  6.07it/s]
Evaluating: 100%|████████████████████████████████████| 107/107 [00:05<00:00, 18.76it/s]
Calculating Accuracy: 100%|██████████████████████████| 107/107 [00:05<00:00, 18.06it/s]
Epoch: 18 | Time: 3m 7s
	Train Loss: 0.7963
	 Val. Loss: 1.3315
	 Val. Accuracy: 0.3778
Saved new best model to best-model-v4p6pl8e.pt
Training: 100%|████████████████████████████████████| 1066/1066 [03:07<00:00,  5.70it/s]
Evaluating: 100%|████████████████████████████████████| 107/107 [00:05<00:00, 18.95it/s]
Calculating Accuracy: 100%|██████████████████████████| 107/107 [00:05<00:00, 18.66it/s]
Epoch: 19 | Time: 3m 18s
	Train Loss: 0.7780
	 Val. Loss: 1.3438
	 Val. Accuracy: 0.3707
Training: 100%|████████████████████████████████████| 1066/1066 [03:09<00:00,  5.63it/s]
Evaluating: 100%|████████████████████████████████████| 107/107 [00:05<00:00, 19.02it/s]
Calculating Accuracy: 100%|██████████████████████████| 107/107 [00:05<00:00, 18.41it/s]
Epoch: 20 | Time: 3m 20s
	Train Loss: 0.7628
	 Val. Loss: 1.3478
	 Val. Accuracy: 0.3829
Training finished.
Evaluating best model on test set...
C:\Users\DELL\Documents\SEMESTER 8\Deep Learning\Assignment_3\DA6401-Assignment-3\src\training\train.py:265: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  if valid_loss < best_valid_loss:
Evaluating: 100%|████████████████████████████████████| 108/108 [00:05<00:00, 18.96it/s]
Calculating Accuracy: 100%|██████████████████████████| 108/108 [00:06<00:00, 17.85it/s]
Test Loss: 1.3910 | Test Accuracy: 0.3534
Saved predictions to predictions/vanilla/predictions-v4p6pl8e.json
