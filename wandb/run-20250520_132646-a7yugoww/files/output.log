Starting training run with config: {'batch_size': 64, 'cell_type': 'lstm', 'clip': 1, 'data_dir': '.', 'dropout': 0.3, 'embedding_size': 64, 'hidden_size': 128, 'language': 'ta', 'learning_rate': 0.005056305687928137, 'max_seq_len': 50, 'momentum': 0.9, 'n_epochs': 20, 'num_layers': 5, 'optimizer': 'adam', 'rmsprop_alpha': 0.99, 'scheduler': 'plateau', 'scheduler_factor': 0.5, 'scheduler_patience': 5, 'scheduler_t_max': 20, 'teacher_forcing_ratio': 0.7, 'use_attention': False, 'weight_decay': 0}
Looking for training file at: .\ta\lexicons\ta.translit.sampled.train.tsv
Special tokens in vocabulary:
Source vocab keys: ['<PAD>', '<UNK>', '< SOS >', '<EOS>', 'a', 'b', 'c', 'd', 'e', 'f']
Target vocab keys: ['<PAD>', '<UNK>', '< SOS >', '<EOS>', 'ஃ', 'அ', 'ஆ', 'இ', 'ஈ', 'உ']
Successfully loaded Dakshina dataset for ta
Train set: 68218 examples
Dev set: 6827 examples
Test set: 6864 examples
Source vocabulary size: 30
Target vocabulary size: 50
Max sequence length: 50
Using device: cuda
The model has 1,266,994 trainable parameters
C:\Users\DELL\anaconda3\envs\Transliteration\lib\site-packages\torch\optim\lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1066/1066 [11:02<00:00,  1.61it/s]
Evaluating Loss: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:13<00:00,  7.65it/s]
Calculating Accuracy: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:06<00:00, 17.61it/s]
Epoch: 01 | Time: 11m 22s
	Train Loss: 0.5166
	 Val. Loss: 0.5628
	 Val. Accuracy: 0.0000
	 Learning Rate: 0.005056
Saved new best model to best-model-a7yugoww.pt
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1066/1066 [07:46<00:00,  2.29it/s]
Evaluating Loss: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:10<00:00,  9.85it/s]
Calculating Accuracy: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:06<00:00, 16.59it/s]
Epoch: 02 | Time: 8m 3s
	Train Loss: 0.4758
	 Val. Loss: 0.5712
	 Val. Accuracy: 0.0000
	 Learning Rate: 0.005056
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1066/1066 [06:26<00:00,  2.76it/s]
Evaluating Loss: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:10<00:00,  9.82it/s]
Calculating Accuracy: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:06<00:00, 17.45it/s]
Epoch: 03 | Time: 6m 43s
	Train Loss: 0.4635
	 Val. Loss: 0.5716
	 Val. Accuracy: 0.0000
	 Learning Rate: 0.005056
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1066/1066 [06:23<00:00,  2.78it/s]
Evaluating Loss: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:10<00:00,  9.81it/s]
Calculating Accuracy: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:05<00:00, 18.31it/s]
Epoch: 04 | Time: 6m 40s
	Train Loss: 0.4510
	 Val. Loss: 0.5632
	 Val. Accuracy: 0.0000
	 Learning Rate: 0.005056
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1066/1066 [06:29<00:00,  2.73it/s]
Evaluating Loss: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:10<00:00,  9.90it/s]
Calculating Accuracy: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:07<00:00, 15.15it/s]
Epoch: 05 | Time: 6m 47s
	Train Loss: 0.4416
	 Val. Loss: 0.6070
	 Val. Accuracy: 0.0000
	 Learning Rate: 0.005056
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1066/1066 [06:19<00:00,  2.81it/s]
Evaluating Loss: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:10<00:00,  9.90it/s]
Calculating Accuracy: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:05<00:00, 21.10it/s]
Epoch: 06 | Time: 6m 35s
	Train Loss: 0.4374
	 Val. Loss: 0.5826
	 Val. Accuracy: 0.0000
	 Learning Rate: 0.005056
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1066/1066 [06:45<00:00,  2.63it/s]
Evaluating Loss: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:10<00:00,  9.93it/s]
Calculating Accuracy: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:05<00:00, 18.39it/s]
Epoch: 07 | Time: 7m 2s
	Train Loss: 0.4355
	 Val. Loss: 0.5717
	 Val. Accuracy: 0.0000
	 Learning Rate: 0.002528
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1066/1066 [06:36<00:00,  2.69it/s]
Evaluating Loss: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:08<00:00, 11.95it/s]
Calculating Accuracy: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:06<00:00, 15.62it/s]
Epoch: 08 | Time: 6m 52s
	Train Loss: 0.4285
	 Val. Loss: 0.5827
	 Val. Accuracy: 0.0000
	 Learning Rate: 0.002528
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1066/1066 [06:39<00:00,  2.67it/s]
Evaluating Loss: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:10<00:00,  9.81it/s]
Calculating Accuracy: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:07<00:00, 14.20it/s]
Epoch: 09 | Time: 6m 57s
	Train Loss: 0.4253
	 Val. Loss: 0.5889
	 Val. Accuracy: 0.0000
	 Learning Rate: 0.002528
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1066/1066 [05:51<00:00,  3.03it/s]
Evaluating Loss: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:05<00:00, 18.48it/s]
Calculating Accuracy: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:04<00:00, 22.21it/s]
Epoch: 10 | Time: 6m 2s
	Train Loss: 0.4233
	 Val. Loss: 0.6061
	 Val. Accuracy: 0.0000
	 Learning Rate: 0.002528
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1066/1066 [04:28<00:00,  3.97it/s]
Evaluating Loss: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:05<00:00, 18.95it/s]
Calculating Accuracy: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:03<00:00, 31.90it/s]
Epoch: 11 | Time: 4m 37s
	Train Loss: 0.4222
	 Val. Loss: 0.5628
	 Val. Accuracy: 0.0000
	 Learning Rate: 0.002528
Training:  73%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                      | 782/1066 [03:41<07:20,  1.55s/it][34m[1mwandb[0m: Network error (ConnectionError), entering retry loop.
Training: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1066/1066 [2:14:03<00:00,  7.55s/it]
Evaluating Loss: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:16<00:00,  6.41it/s]
Calculating Accuracy: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:07<00:00, 14.27it/s]
Epoch: 12 | Time: 134m 27s
	Train Loss: 0.4201
	 Val. Loss: 0.5558
	 Val. Accuracy: 0.0000
	 Learning Rate: 0.002528
Saved new best model to best-model-a7yugoww.pt
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1066/1066 [37:03<00:00,  2.09s/it]
Evaluating Loss: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:05<00:00, 19.35it/s]
Calculating Accuracy: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:02<00:00, 40.44it/s]
Epoch: 13 | Time: 37m 11s
	Train Loss: 0.4194
	 Val. Loss: 0.5601
	 Val. Accuracy: 0.0000
	 Learning Rate: 0.002528
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1066/1066 [04:08<00:00,  4.29it/s]
Evaluating Loss: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:05<00:00, 19.24it/s]
Calculating Accuracy: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:04<00:00, 22.29it/s]
Epoch: 14 | Time: 4m 18s
	Train Loss: 0.4186
	 Val. Loss: 0.6276
	 Val. Accuracy: 0.0000
	 Learning Rate: 0.002528
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1066/1066 [04:20<00:00,  4.09it/s]
Evaluating Loss: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:05<00:00, 19.35it/s]
Calculating Accuracy: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:02<00:00, 39.37it/s]
Epoch: 15 | Time: 4m 29s
	Train Loss: 0.4189
	 Val. Loss: 0.5606
	 Val. Accuracy: 0.0000
	 Learning Rate: 0.002528
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1066/1066 [04:16<00:00,  4.16it/s]
Evaluating Loss: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:05<00:00, 18.28it/s]
Calculating Accuracy: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:03<00:00, 31.63it/s]
Epoch: 16 | Time: 4m 25s
	Train Loss: 0.4168
	 Val. Loss: 0.5679
	 Val. Accuracy: 0.0000
	 Learning Rate: 0.002528
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1066/1066 [04:19<00:00,  4.11it/s]
Evaluating Loss: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 107/107 [00:05<00:00, 19.13it/s]
Calculating Accuracy: 100%|███| 107/107 [00:07<00:00, 14.35it/s]
Epoch: 17 | Time: 4m 32s
	Train Loss: 0.4174
	 Val. Loss: 0.6965
	 Val. Accuracy: 0.0000
	 Learning Rate: 0.002528
Training: 100%|█████████████| 1066/1066 [04:25<00:00,  4.02it/s]
Evaluating Loss: 100%|███████████████████████████████| 107/107 [00:05<00:00, 19.05it/s]
Calculating Accuracy: 100%|██████████████████████████| 107/107 [00:06<00:00, 16.04it/s]
Epoch: 18 | Time: 4m 37s
	Train Loss: 0.4152
	 Val. Loss: 0.6273
	 Val. Accuracy: 0.0000
	 Learning Rate: 0.001264
Training: 100%|████████████████████████████████████| 1066/1066 [04:21<00:00,  4.08it/s]
Evaluating Loss: 100%|███████████████████████████████| 107/107 [00:05<00:00, 18.76it/s]
Calculating Accuracy: 100%|██████████████████████████| 107/107 [00:04<00:00, 25.86it/s]
Epoch: 19 | Time: 4m 31s
	Train Loss: 0.4115
	 Val. Loss: 0.5818
	 Val. Accuracy: 0.0000
	 Learning Rate: 0.001264
Training: 100%|████████████████████████████████████| 1066/1066 [04:24<00:00,  4.03it/s]
Evaluating Loss: 100%|███████████████████████████████| 107/107 [00:05<00:00, 19.15it/s]
Calculating Accuracy: 100%|██████████████████████████| 107/107 [00:02<00:00, 41.93it/s]
Epoch: 20 | Time: 4m 32s
	Train Loss: 0.4124
	 Val. Loss: 0.5603
	 Val. Accuracy: 0.0000
	 Learning Rate: 0.001264
Training finished.
Evaluating best model on test set...
C:\Users\DELL\Documents\SEMESTER 8\Deep Learning\Assignment_3\DA6401-Assignment-3\src\training\train.py:308: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_save_path, map_location=device))
Evaluating Loss: 100%|███████████████████████████████| 108/108 [00:05<00:00, 18.45it/s]
Calculating Accuracy: 100%|██████████████████████████| 108/108 [00:03<00:00, 31.47it/s]
Test Loss: 0.5574 | Test Accuracy: 0.0000
Saved predictions to predictions/vanilla/predictions-a7yugoww.json
